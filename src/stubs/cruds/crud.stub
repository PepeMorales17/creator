<?php

namespace {{namespace}};

use Pp\Creator\Generates\Crud;
use Pp\Creator\Models\Menu;
use Illuminate\Support\Facades\DB;

class {{name:plural}}Crud extends Crud
{

    // protected $optional = true;

    public function run()
    {
        return [
            'migration' => true,
            'model' => true,
            'form' => true,
            'controller' => true,
            'crud_vue' => true,
        ];
    }

    public static function menu($parent = null)
    {
        return DB::transaction(function () use($parent){
            $index = Menu::create([
                "name" => "{{singular}}",
                "icon" => "",
                "description" => "Todos los {{plural}}",
                "namespace" => "{{name}}.index",
                "parent_id" => $parent,
            ]);
            $form = Menu::create([
                "name" => "Crear {{singular}}",
                "icon" => "",
                "description" => "Crear {{singular}}",
                "namespace" => "{{name}}.create",
                "parent_id" => $index->id,
            ]);
            return [$index, $form];
        });

    }

    const MENUS = [
            'crud' => [
                '{{name}}.index' => ['name' => 'Lista', 'route' => '{{name}}.index', 'title' => 'Listado de {{plural}}'],
                '{{name}}.create' => ['name' => 'Crear', 'route' => '{{name}}.create', 'title' => 'Crear {{singular}}'],
            ]
    ];

    public function attrs()
    {

        return [
            $this->attr('id', 'id'),
        ];
    }

    protected function externalRelations()
    {
        return [

        ];
    }

    public function addTablesBeforeMigrate()
    {
        return [
        ];
    }
}
